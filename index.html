<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Easy Connection Between Sharepoint and R • sharepointr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Easy Connection Between Sharepoint and R">
<meta property="og:description" content="Wrapper over M365R package to allow a simplified connection between Sharepoint and R.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">sharepointr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="sharepointr">Sharepointr<a class="anchor" aria-label="anchor" href="#sharepointr"></a>
</h1></div>
<p>This package is designed to simplify the process of connecting to and interacting with Microsoft SharePoint sites using the Microsoft Graph API. It provides functions list sites and files already present in Sharepoint, and perform basic operations such as uploading and downloading files to SharePoint.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the package from Github using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"department-for-transport-public/sharepointr"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>The first time you use the package, you will need to authenticate with your Microsoft account. You will be prompted to do this the first time you run any of the functions in the package. You will receive a notification in the console which provides a link to go to, and a code to enter at this link.</p>
<p>You may also be asked to enter your Microsoft credentials; it’s fine to do this.</p>
<p>Once you’ve authenticated the first time, your credentials will be saved, and you won’t need to log in again unless your credentials expire or you clear them.</p>
</div>
<div class="section level2">
<h2 id="how-sharepoint-is-structured">How Sharepoint is structured<a class="anchor" aria-label="anchor" href="#how-sharepoint-is-structured"></a>
</h2>
<p>To make use of the functions in this package, you will need to know how the structure of Sharepoint folders and urls works. A typical SharePoint URL looks like this:</p>
<pre><code>https://yourtenant.sharepoint.com/sites/yoursite/Shared_Documents/yourfolder/yourfile.txt</code></pre>
<p>In this example:</p>
<ul>
<li>
<code>yourtenant</code> is the name of your SharePoint tenant. This is set automatically in this package and you don’t need to worry about it.</li>
<li>
<code>yoursite</code> is the name of the SharePoint <strong>site</strong> you are accessing. This is the site where your files are stored.</li>
<li>
<code>Shared_Documents</code> is the name of the <strong>drive</strong> where your files are stored.</li>
<li>
<code>yourfolder/yourfile.txt</code> is the full <strong>file path</strong> of the location of your file. This includes any folders below the drive, and the name of the file itself, as well as the file extension (e.g. docx or xlsx).</li>
</ul>
<p>For all of the functions in this package, you will be asked to provide the <code>site</code>, <code>drive</code> and <code>path</code> parameters. These correspond to the <code>yoursite</code>, <code>Shared_Documents</code> and <code>yourfolder/yourfile.txt</code> parts of the URL above.</p>
</div>
<div class="section level2">
<h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>
<div class="section level3">
<h3 id="helper-listing-functions">Helper listing functions<a class="anchor" aria-label="anchor" href="#helper-listing-functions"></a>
</h3>
<ul>
<li><p><code>list_drives()</code>: Lists all drives (document libraries) in the SharePoint site you are accessing. This makes it easy to find the drive you want to work with, and troubleshoot if you’re struggling.</p></li>
<li><p><code><a href="reference/list_sharepoint_objects.html">list_sharepoint_objects()</a></code>: Lists all files and folders in a specified Sharepoint drive. This is useful for navigating the structure of your Sharepoint site and finding the files you want to work with. By default, it lists the contents of the root folder of the specified drive, but you can specify a subfolder by providing the <code>path</code> parameter. For example:</p></li>
</ul>
<pre><code><span><span class="fu"><a href="reference/list_sharepoint_objects.html">list_sharepoint_objects</a></span><span class="op">(</span>site <span class="op">=</span> <span class="st">"yoursite"</span>, drive <span class="op">=</span> <span class="st">"Shared_Documents"</span>, path <span class="op">=</span> <span class="st">"yourfolder"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/list_sharepoint_objects.html">list_sharepoint_objects</a></span><span class="op">(</span>site <span class="op">=</span> <span class="st">"yoursite"</span>, drive <span class="op">=</span> <span class="st">"Shared_Documents"</span>, path <span class="op">=</span> <span class="st">"yourfolder/subfolder"</span><span class="op">)</span></span></code></pre>
<p>The first example will list all files and folders in the <code>yourfolder</code> subfolder of the <code>Shared_Documents</code> drive in the <code>yoursite</code> SharePoint site. The second example will list all files and folders in the <code>subfolder</code> folder of the <code>yourfolder</code> folder in the same drive.</p>
</div>
<div class="section level3">
<h3 id="file-imports">File imports<a class="anchor" aria-label="anchor" href="#file-imports"></a>
</h3>
<p>These functions allow you to import data and files stored in sharepoint. There are two different approaches available; if you are reading in data from a file, you can use the <code><a href="reference/read_sharepoint_file.html">read_sharepoint_file()</a></code> function, which will automatically read the file into R using the appropriate function based on the file type (e.g. <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv()</a></code> for CSV files, <code>read.xlsx()</code> for xlsx files). This creates and deletes a temporary file, so you don’t need to worry about file management yourself.</p>
<p>If you want to download a file to your local machine, for example a template file, you can use the <code><a href="reference/import_sharepoint.html">import_sharepoint()</a></code> function, which will save the file to a specified location on your computer. This won’t work for large files (&gt; 500MB), when you will get a message asking you to use alternative storage instead.</p>
<ul>
<li><p><code><a href="reference/read_sharepoint_file.html">read_sharepoint_file()</a></code>: Reads a file from SharePoint and returns the data in R. This function automatically detects the file type and uses the appropriate function to read it for common data file types. You can specify the <code>site</code>, <code>drive</code>, and <code>file_path</code> parameters to locate the file you want to read. For some xlsx files, openxlsx gives different results to readxl; you may specify <code>use_openxlsx = TRUE</code> if you would like to use openxlsx specifically.</p></li>
<li><p><code><a href="reference/import_sharepoint.html">import_sharepoint()</a></code>: Downloads a file from SharePoint to your local machine. This is useful for downloading files that you want to keep on your computer, such as templates or reports. You can specify the <code>site</code>, <code>drive</code>, and <code>path</code> parameters to locate the file you want to download, and the <code>file_path</code> parameter to specify where to save the file on your local drive.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="file-exports">File exports<a class="anchor" aria-label="anchor" href="#file-exports"></a>
</h3>
<p>These functions allow you to export data and files to SharePoint. If you have a data frame that you want to save as a file in SharePoint, you can use the <code><a href="reference/export_sharepoint.html">export_sharepoint()</a></code> function, which will automatically write the data frame to a file in SharePoint using the appropriate function based on the file type. This creates and deletes a temporary file, so you don’t need to worry about file management yourself.</p>
<p>If you want to upload a file from your local machine to SharePoint, you can use the <code><a href="reference/export_sharepoint_file.html">export_sharepoint_file()</a></code> function, which will save the file to a specified location in SharePoint.</p>
<p>You can also upload an entire folder of files to SharePoint using the <code><a href="reference/export_sharepoint_folder.html">export_sharepoint_folder()</a></code> function, which will recursively upload all files in the specified folder to SharePoint.</p>
<ul>
<li><p><code><a href="reference/export_sharepoint.html">export_sharepoint()</a></code>: Exports a data frame to SharePoint as a file. This function automatically detects the file type and uses the appropriate function to write it for common data file types. You can specify the <code>site</code>, <code>drive</code>, and <code>dest_path</code> parameters to locate where you want to save the file in SharePoint.</p></li>
<li><p><code><a href="reference/export_sharepoint_file.html">export_sharepoint_file()</a></code>: Uploads a file from your local machine to SharePoint. This is useful for uploading files that you have created or modified on your computer, such as reports or unusual file types. You can specify the <code>site</code>, <code>drive</code>, and <code>dest_path</code> parameters to locate where you want to save the file in SharePoint, and the <code>file</code> parameter to specify the path to the file on your local machine.</p></li>
<li><p><code><a href="reference/export_sharepoint_folder.html">export_sharepoint_folder()</a></code>: Uploads an entire folder of files to SharePoint. This is useful for uploading multiple files at once, such as a folder of reports or data files. You can specify the <code>site</code>, <code>drive</code>, and <code>dest_path</code> parameters to locate where you want to save the files in SharePoint, and the <code>dest_path</code> parameter to specify the path to the folder on your local machine. If a destination is not specified, the function will copy the files to the root of the specified drive in SharePoint, in the same folder structure as you have locally.</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="rendering-rmarkdown-documents-directly-to-sharepoint">Rendering Rmarkdown documents directly to Sharepoint<a class="anchor" aria-label="anchor" href="#rendering-rmarkdown-documents-directly-to-sharepoint"></a>
</h2>
<p>You can also render Rmarkdown documents directly to SharePoint using the <code><a href="reference/render_to_sharepoint.html">render_to_sharepoint()</a></code> function. This function will render an Rmarkdown document and save the output file directly to SharePoint, without needing to save it locally first.</p>
<ul>
<li>
<code><a href="reference/render_to_sharepoint.html">render_to_sharepoint()</a></code>: Renders an Rmarkdown document and saves the output file directly to SharePoint. You can specify the <code>site</code>, <code>drive</code>, and <code>path</code> parameters to locate where you want to save the file in SharePoint, and the <code>input</code> parameter to specify the path to the Rmarkdown file on your local machine. The function will automatically detect the output format (e.g. HTML, PDF, Word) and save the file in the appropriate format. Additional parameters can be passed to the <code><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">rmarkdown::render()</a></code> function using the <code>...</code> argument, allowing you to customize the rendering process as needed.</li>
</ul>
</div>
<div class="section level2">
<h2 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h2>
<div class="section level3">
<h3 id="im-having-to-repeatedly-login">I’m having to repeatedly login<a class="anchor" aria-label="anchor" href="#im-having-to-repeatedly-login"></a>
</h3>
<p>Usually this is accompanied by an error message saying that a file is missing; this is due to corruption of your credentials file. You can reset this by running <code>rm(~/.local/share/AzureR/graph_logins.json)</code>; you will need to log in one final time, but then your credentials should be remembered.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing sharepointr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Francesca Bryden <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Francesca Bryden.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
